
# คู่มือการใช้งาน Naranjo Assessor (Local AI)

ระบบนี้ถูกออกแบบมาให้ทำงานบนเครื่องคอมพิวเตอร์ส่วนตัว (Local Desktop) โดยไม่ต้องใช้อินเทอร์เน็ตในการประมวลผล AI ข้อมูลผู้ป่วยจะถูกเก็บและประมวลผลภายในเครื่องเท่านั้น

## 1. สิ่งที่ต้องติดตั้ง (Prerequisites)

### 1.1 Python
*   ดาวน์โหลดและติดตั้ง Python (เวอร์ชัน 3.8 ขึ้นไป) จาก [python.org](https://www.python.org/downloads/)
*   ตอนติดตั้ง **อย่าลืมติ๊กถูกช่อง "Add Python to PATH"**

### 1.2 Ollama (สำหรับรัน AI)
*   ดาวน์โหลด Ollama จาก [ollama.com](https://ollama.com/)
*   ติดตั้งโปรแกรมให้เรียบร้อย

## 2. การเตรียม AI Model (MedGemma)

1.  เปิด **Command Prompt (cmd)** หรือ Terminal
2.  พิมพ์คำสั่งเพื่อดึงโมเดล (หรือสร้างโมเดล) ที่คุณต้องการใช้:
    ```bash
    ollama pull medgemma
    ```
    *(หมายเหตุ: หาก `medgemma` เป็นชื่อโมเดล custom ของคุณ ให้ตรวจสอบว่าคุณได้ create โมเดลนั้นใน ollama แล้ว หรือหากต้องการใช้โมเดลอื่น เช่น `llama3` หรือ `gemma:2b` ให้แก้ไขชื่อในไฟล์ `app.py` บรรทัดที่ 10)*

3.  ทดสอบว่า Ollama ทำงานปกติโดยพิมพ์:
    ```bash
    ollama run medgemma "hello"
    ```
    ถ้า AI ตอบกลับมา แสดงว่าพร้อมใช้งาน (พิมพ์ `/bye` เพื่อออก)

## 3. การติดตั้งและรันโปรแกรม

1.  แตกไฟล์โปรเจกต์นี้ไว้ในโฟลเดอร์ (เช่น `C:\NaranjoApp`)
2.  เปิด Command Prompt ในโฟลเดอร์นี้
3.  ติดตั้ง Library ที่จำเป็น (ทำครั้งเดียว):
    ```bash
    pip install -r requirements.txt
    ```
4.  รันโปรแกรม:
    ```bash
    python app.py
    ```
5.  หน้าจอจะแสดงข้อความว่า `Running on http://127.0.0.1:5000`
6.  เปิดเว็บเบราว์เซอร์ (Chrome/Edge) แล้วเข้า URL: `http://localhost:5000`

## 4. การใช้งาน

1.  กรอกข้อมูลผู้ป่วยและประวัติการแพ้ยา
2.  ทำแบบประเมิน Naranjo ทั้ง 10 ข้อ
3.  กดปุ่ม **"วิเคราะห์ผลทางคลินิกด้วย AI (Local)"**
4.  ระบบจะส่งข้อมูลไปที่ Ollama บนเครื่องของคุณและแสดงผลวิเคราะห์

## การแก้ไขปัญหาเบื้องต้น (Troubleshooting)

*   **Error: "Connection to Ollama failed"**:
    *   ตรวจสอบว่าโปรแกรม Ollama เปิดอยู่ (ดูที่ Taskbar)
    *   ลองเปิด cmd แล้วพิมพ์ `ollama list` เพื่อดูว่ามีโมเดลชื่อ `medgemma` หรือไม่

*   **IdCard Error**:
    *   ในเวอร์ชันนี้ได้แก้ไขโค้ดให้ใช้ `CreditCard` icon แทน `IdCard` แล้ว เพื่อป้องกันปัญหา version mismatch ของ library

*   **AI ตอบช้า**:
    *   ความเร็วขึ้นอยู่กับสเปคเครื่องคอมพิวเตอร์ (RAM/GPU) และขนาดของ Model (4B จะเร็วกว่า 7B)
